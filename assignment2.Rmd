```{r}
load("proj_data.Rdata")
modell <- glm(Resultat ~ Alder + Kon + Utbildare, 
              data = data_individ,
              family = "binomial")
summary(modell)
```
```{r}
source("funktioner.R")
y <- matrix(data_individ$Resultat, ncol = 1)
X <- model.matrix(Resultat ~ Alder + Kon + Utbildare, 
                  data = data_individ)
```

## Task 1:

Verify, using functions I and NR from Part I, that the z value column of the output are Wald statistics (see the textbook page 128).
Z value column? Which is that? the output?
```{r}

## Are these the z values we are supposed to work with?
z_values <- unname(summary(modell)$coefficients[, "Estimate"]) #THESE ARE NOT Z VALUES DO NOT TRUST

```

```{r}
  theta0 <- c(0, 0, 0, 0)
  NR_estimate <- NR(theta0, 5, y, X)
  I_estimate <-I(NR_estimate, y, X) # Is NR the z that we hear about?
```
```{r}
  # According to the book 
  
  #true_wald_statistics <-%*%(NR_estimate-theta0) # Walder fixed: It was just the inverse
  true_wald_statistics <- (NR_estimate- theta0)/(sqrt(diag(solve(I(NR_estimate, y, X)))))
  print(true_wald_statistics)
  print(z_values)
```
## Task 2:

Compute the generalized likelihood ratio statistics (see textbook chapter 5.5) that corresponds to the Wald statistics in Task 1 and determine the corresponding ð‘ƒ
-values. Note that your likelihood ratio statistics should be of the same order of magnitude as the squared Wald statistics (why?).

```{r}
  eta <- NR(theta0 = c(0, 0, 0), niter = 10, y = y, X = X[, -3])
  eta
```


